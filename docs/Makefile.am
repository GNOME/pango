## Process this file with automake to create Makefile.in.

# The name of the module.
DOC_MODULE=pango

# The top-level SGML file.
DOC_MAIN_SGML_FILE=pango-docs.sgml

# Extra options to supply to gtkdoc-scan
SCAN_OPTIONS=--deprecated-guards="PANGO_DISABLE_DEPRECATED"

# Extra options to supply to gtkdoc-mkdb.
MKDB_OPTIONS=--sgml-mode --output-format=xml

# The directory containing the source code. Relative to $(srcdir)
DOC_SOURCE_DIR=../pango

# Used for dependencies
HFILE_GLOB=$(top_srcdir)/pango/*.h
CFILE_GLOB=$(top_srcdir)/pango/*.c

# Headers to ignore
IGNORE_HFILES=			\
	pangoatsui-private.h	\
	pangocairo-private.h	\
	pangocairo-fc.h		\
	pangocairo-win32.h	\
	pangocairo-atsui.h	\
	pango-color-table.h	\
	pango-engine-private.h	\
	pango-impl-utils.h	\
	pango-glyph-item-private.h	\
	pango-layout-private.h	\
	pango-script-table.h	\
	pango-script-private.h	\
	pangofc-private.h	\
	pangoft2-private.h	\
	pangowin32-private.h	\
	pangoatsui-private.h	\
	pangox-private.h	\
	pangoxft-private.h	\
	pango-ot-private.h	\
	pango-script-lang-table.h	\
	pango-language-sample-table.h 	\
	pangocoretext-private.h		\
	pangoatsui-private.h

# CFLAGS and LDFLAGS for compiling scan program. Only needed
# if $(DOC_MODULE).types is non-empty.
INCLUDES =               	\
	-DPANGO_ENABLE_BACKEND	\
	-DPANGO_ENABLE_ENGINE	\
	-I$(top_srcdir)		\
	-I$(top_builddir)	\
	$(GLIB_CFLAGS)		\
	$(XFT_CFLAGS)		\
	$(CAIRO_CFLAGS)		\
	$(FREETYPE_CFLAGS)	\
	$(X_CFLAGS)

# We're assuming here that we'll only regenerate the
# HTML docs on Unix. We don't get introspection on Win32
# specific types, but that isn't a big deal.

GTKDOC_LIBS = $(top_builddir)/pango/libpango-1.0.la

if HAVE_FREETYPE
GTKDOC_LIBS += $(top_builddir)/pango/libpangoft2-1.0.la
endif

if HAVE_XFT
GTKDOC_LIBS += $(top_builddir)/pango/libpangoxft-1.0.la
endif

if HAVE_CAIRO
GTKDOC_LIBS += $(top_builddir)/pango/libpangocairo-1.0.la
endif

GTKDOC_LIBS += $(GLIB_LIBS)

# Non-autogenerated SGML files to be included in $(DOC_MAIN_SGML_FILE)
content_files =				\
	pango_markup.sgml		\
	version.xml

# Images to copy into HTML directory
HTML_IMAGES =				\
	layout.gif			\
	rotated-text.png

if ENABLE_DOC_CROSS_REFERENCES
# Extra options to supply to gtkdoc-fixref
FIXXREF_OPTIONS=--extra-dir=$(GLIB_PREFIX)/share/gtk-doc/html/glib \
	--extra-dir=$(CAIRO_PREFIX)/share/gtk-doc/html/cairo
endif

include $(top_srcdir)/gtk-doc.make

# This line really belongs in gtk-doc.mk
$(REPORT_FILES): sgml-build.stamp

pango.types:
	@echo "Rebuilding $@"
	@LANG=C; LIST=$$(grep 'pango_[_a-zA-Z0-9]*_get_type' $(HFILE_GLOB) | grep -v '\(private\|atsui\|core_text\|win32\)' | sed 's/\([^:]*:\).*\(pango[_a-zA-Z0-9]*_get_type\).*/\1\2/') && \
	echo "$$LIST" | sed 's/.*\/\(pango\/.*\):.*/#include <\1>/' | sort -u > $@.tmp && \
	echo >> $@.tmp && \
	echo "$$LIST" | cut -d : -f 2 | sort -u >> $@.tmp && \
	mv $@.tmp $@

BUILT_SOURCES = pango.types

########################################################################

MAINTAINERCLEANFILES = $(BUILT_SOURCES)
EXTRA_DIST +=				\
	layout.fig			\
	layout.eps			\
	version.xml.in			\
	check.docs			\
	pango.types

# force doc rebulid after configure
dist-hook-local: dist-local-check-no-cross-references all-local

#
# Require gtk-doc when making dist
#
if ENABLE_DOC_CROSS_REFERENCES
dist-local-check-no-cross-references:
	@echo "*** --disable-doc-cross-references must be used in order to make dist"
	@false
else
dist-local-check-no-cross-references:
endif

.PHONY: dist-local-check-no-cross-references

if ENABLE_GTK_DOC
TESTS = check.docs
TESTS_ENVIRONMENT = srcdir="$(srcdir)" top_srcdir="$(top_srcdir)" MAKE="$(MAKE) $(AM_MAKEFLAGS)" DOC_MODULE="$(DOC_MODULE)" REPORT_FILES="$(REPORT_FILES)"
endif

-include $(top_srcdir)/git.mk
